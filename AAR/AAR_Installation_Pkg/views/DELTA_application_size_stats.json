{"queryType":"SQL", "query": "create or replace view `dfs`.`AAR  Views`.DELTA_application_size_stats as SELECT s.snapshot, s.snapshot_time, s.snapshot_date, s.snapshot_order, s.appname, s.appResults.reference.name as sMetricName, s.appResults.reference.shortName as sMetricShortName, s.appResults.`result`.`value` as sValue  FROM (SELECT  asj.number as snapshot, DENSE_RANK() OVER(PARTITION BY asj.application.name ORDER BY asj.number DESC) as snapshot_order, asj.`date`.`time` as snapshot_time, asj.`date`.`isoDate` as snapshot_date, asj.application.name as appname, FLATTEN(asj.applicationResults) as appResults FROM `dfs`.`AAR  Inputs`.`./CLIENT-Size.json` as asj ) as s WHERE s.snapshot_order < 3"}
