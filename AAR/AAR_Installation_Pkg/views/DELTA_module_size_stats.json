{"queryType":"SQL", "query": "create or replace view `dfs`.`AAR  Views`.DELTA_module_size_stats as SELECT m.snapshot,m.snapshot_date,m.appname,m.smName,m.modulesResults.moduleSnapshot.name AS module_name,m.modulesResults.`result`.`value` AS mValue FROM (SELECT ms.snapshot,ms.snapshot_date, ms.appname,ms.appResults.reference.name AS smName,ms.appResults.reference.name AS smShortName,FLATTEN(ms.appResults.moduleResults) AS modulesResults FROM (SELECT number as snapshot, msj.`date`.isoDate AS snapshot_date,DENSE_RANK() OVER(PARTITION BY msj.application.name ORDER BY msj.number DESC) as snapshot_order,msj.application.name AS appname, FLATTEN(msj.applicationResults) AS appResults FROM `dfs`.`AAR  Inputs`.`./CLIENT-ModuleSizeStats.json` AS msj ) AS ms WHERE ms.snapshot_order < 3) AS m"}
